Speak={fullString:"",status:!1,time:500,speed:0,Start:function(){setInterval(function(){chrome.tts.isSpeaking(function(e){0==e&&Speak.fullString.length>0&&Speak.ReadText(Speak.fullString)})},this.time),chrome.contextMenus.removeAll(function(){}),chrome.contextMenus.create({type:"normal",title:"ОЗВУЧИТЬ ТЕКСТ",contexts:["selection"],onclick:function(e,t){Speak.ReadText(e.selectionText)}})},ReadText:function(e){e=e.replace(/[\/\]\[\{\}\»\«\-\)\(\—\?\!]/g,""),console.log("444");var t=e.split(" ");console.log(t);for(var n=0;n<t.length;n++)""==t[n]&&(t.splice(n,1),n--);t.length>20?(Speak.fullString=t.slice(20).join(" "),this.time=0):(Speak.fullString=0,this.time=500),console.log(Speak.speed),chrome.tts.speak(t.slice(0,20).join(" "),{rate:Speak.speed})}},window.onload=function(){Speak.Start()},chrome.runtime.onMessage.addListener(function(e,t,n){Speak.speed=parseFloat(e.speed),Speak.ReadText(e.greeting)});